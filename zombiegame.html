<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zombie Survivor</title>
    <link rel="stylesheet" href="zstyle.css">
</head>
<body>
 <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        <div id="gameUI">
            <div>Health: <span id="health">100</span></div>
            <div>Score: <span id="score">0</span></div>
            <div>Stage: <span id="wave">1</span></div>
            <div>Player Level: <span id="level">1</span></div>
            <div>XP: <span id="xp">0/100</span></div>
            <div>Money: $<span id="currency">0</span></div>
            <div>Weapon: <span id="currentWeaponName">Pistol</span></div>
            <div>Zombies: <span id="zombieCount">0</span></div>
            <div>Tools: <span id="playerTools">X N:0 W:0</span></div>
            <div id="difficultyDisplay" style="color: #ffaa00; font-size: 8px; font-weight: bold;">NORMAL MODE</div>
            <div style="color: #888; font-size: 8px; margin-top: 4px;">WASD: Move | T: Auto | B: Store | R: Walls</div>
            <div style="color: #00ff00; font-size: 8px;">Auto: <span id="autoTargetStatus">ON</span></div>
        </div>
        <button id="pauseButton" onclick="togglePause()">⏸</button>
        <button id="companionButton" onclick="buyCompanion()">+ Add Ally ($100)</button>
        <button id="fullscreenButton" onclick="toggleFullscreen()">⛶</button>
        
        <!-- Mobile Touch Controls -->
        <div id="mobileControls" style="display: none;">
            <div id="virtualJoystick">
                <div id="joystickBase">
                    <div id="joystickKnob"></div>
                </div>
            </div>
            <div id="mobileActionButtons">
                <button class="mobile-btn" id="mobileShootBtn">🔫</button>
                <button class="mobile-btn" id="mobileAutoBtn">🎯</button>
                <button class="mobile-btn" id="mobileStoreBtn">🏪</button>
                <button class="mobile-btn" id="mobileWallBtn">🧱</button>
                <button class="mobile-btn" id="mobilePauseBtn">⏸️</button>
            </div>
        </div>
        
        <div id="startMenu">
            <div class="start-menu-content">
                <h1 class="game-title">ZOMBIE SURVIVOR</h1>
                <div class="subtitle">🧟 Defend the Sanctuary 🧟</div>
                
                <div class="difficulty-selection">
                    <h3>🎚️ SELECT DIFFICULTY</h3>
                    <div class="difficulty-buttons">
                        <button onclick="startNewGame('easy')" class="difficulty-button easy-mode" id="easyButton">
                            😊 EASY MODE
                            <div class="difficulty-desc">Relaxed gameplay, forgiving stats</div>
                        </button>
                        <button onclick="startNewGame('normal')" class="difficulty-button normal-mode" id="normalButton">
                            🎯 NORMAL MODE
                            <div class="difficulty-desc">Balanced challenge for most players</div>
                        </button>
                        <button onclick="startNewGame('hardcore')" class="difficulty-button hardcore-mode" id="hardcoreButton">
                            💀 HARDCORE MODE
                            <div class="difficulty-desc">Brutal survival challenge</div>
                        </button>
                    </div>
                </div>
                
                <div class="menu-options">
                    <button onclick="showHighScores()" class="menu-button" id="highScoresButton">🏆 HIGH SCORES</button>
                    <button onclick="showInstructions()" class="menu-button" id="instructionsButton">📖 HOW TO PLAY</button>
                </div>
                
                <div class="game-description">
                    <p>Survive endless waves of zombies while defending your sanctuary. Use weapons, build walls, and hire allies to stay alive as long as possible!</p>
                </div>
                
                <div class="version-info">v1.0 - Hardcore Edition</div>
            </div>
        </div>
        
        <div id="pauseOverlay">
            <div class="pause-title">PAUSED</div>
            <div class="how-to-play">
                <h3>🎮 HOW TO PLAY</h3>
                
                <div class="controls-section">
                    <h4>⌨️ Controls</h4>
                    <div class="control-grid">
                        <div><strong>WASD</strong> - Move Player</div>
                        <div><strong>Mouse</strong> - Aim & Auto-fire</div>
                        <div><strong>T</strong> - Toggle Auto-targeting</div>
                        <div><strong>B</strong> - Open/Close Store</div>
                        <div><strong>R</strong> - Rebuild Walls (need tools)</div>
                        <div><strong>P / ESC</strong> - Pause Game</div>
                        <div><strong>F11</strong> - Toggle Fullscreen</div>
                        <div><strong>F</strong> - Skip Level 7 (if stuck)</div>
                        <div><strong>Mouse Wheel</strong> - Scroll in Store</div>
                    </div>
                </div>

                <div class="gameplay-section">
                    <h4>🎯 Objective</h4>
                    <p>Survive waves of zombies while defending the sanctuary. Kill zombies to gain XP, level up, and earn money to buy better weapons and supplies.</p>
                </div>

                <div class="systems-section">
                    <h4>🛠️ Game Systems</h4>
                    <div class="system-grid">
                        <div><strong>🏪 Store:</strong> Buy weapons, tools, and supplies</div>
                        <div><strong>🧱 Walls:</strong> Protect sanctuary from zombies</div>
                        <div><strong>👥 Allies:</strong> Hire companions to help fight</div>
                        <div><strong>🔧 Tools:</strong> Hammer, nails, wood to repair walls</div>
                        <div><strong>⚡ Safe Zone:</strong> Heal inside the sanctuary</div>
                        <div><strong>🎯 Auto-Target:</strong> Automatically aims at nearest zombie</div>
                    </div>
                </div>

                <div class="tips-section">
                    <h4>💡 Tips</h4>
                    <ul>
                        <li>Stay in the sanctuary to heal</li>
                        <li>Buy tools early to repair walls</li>
                        <li>Higher level weapons unlock as you progress</li>
                        <li>Allies help but cost money to maintain</li>
                        <li>Use mouse wheel to scroll through all weapons in store</li>
                        <li>Some weapons have special abilities (pierce, explosive, etc.)</li>
                    </ul>
                </div>
                
                <div class="pause-buttons">
                    <button onclick="togglePause()">Resume Game</button>
                    <button onclick="quitGame()" class="quit-button">Quit to Menu</button>
                    <a href="index.html" class="home-button">← Back to Website</a>
                </div>
            </div>
        </div>
        <div id="gameOver">
            <h2 id="gameOverMessage">Game Over!</h2>
            <p>Final Score: <span id="finalScore">0</span></p>
            <p>Waves Survived: <span id="finalWave">0</span></p>
            <div id="newHighScore" style="display: none;">
                <h3>🎉 NEW HIGH SCORE! 🎉</h3>
                <input type="text" id="playerName" placeholder="Enter your name" maxlength="20">
                <button onclick="saveHighScore()">Save Score</button>
            </div>
            <button onclick="restartGame()">Play Again</button>
            <button onclick="showHighScores()">View High Scores</button>
            <button onclick="returnToMenu()" class="menu-button">Return to Menu</button>
        </div>

        <div id="highScoresModal" style="display: none;">
            <div class="modal-content">
                <h2>🏆 HIGH SCORES 🏆</h2>
                <div id="highScoresList"></div>
                <button onclick="closeHighScores()">Close</button>
                <button onclick="clearHighScores()">Clear All Scores</button>
                <button onclick="returnToMenu()" class="menu-button">Return to Menu</button>
            </div>
        </div>
    </div>

    <script src="zscript.js"></script>
    <script>


        // Mobile detection
        function isMobile() {
            return window.innerWidth <= 768 || /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        }

        // Add proper mobile touch support for difficulty buttons
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for game script to load
            setTimeout(function() {
                const buttons = [
                    { id: 'easyButton', difficulty: 'easy' },
                    { id: 'normalButton', difficulty: 'normal' },
                    { id: 'hardcoreButton', difficulty: 'hardcore' }
                ];
                
                buttons.forEach(function(btnInfo) {
                    const btn = document.getElementById(btnInfo.id);
                    if (btn) {
                        // Add touch event for mobile
                        btn.addEventListener('touchend', function(e) {
                            e.preventDefault();
                            if (typeof window.startNewGame === 'function') {
                                window.startNewGame(btnInfo.difficulty);
                            }
                        });
                        
                        // Also ensure click works
                        btn.addEventListener('click', function(e) {
                            e.preventDefault();
                            if (typeof window.startNewGame === 'function') {
                                window.startNewGame(btnInfo.difficulty);
                            }
                        });
                    }
                });
            }, 2000);
            
            // Mobile controls management
            if (isMobile()) {
                const mobileControls = document.getElementById('mobileControls');
                if (mobileControls) {
                    // Show mobile controls when game is running
                    function updateMobileControls() {
                        const startMenu = document.getElementById('startMenu');
                        if (startMenu && startMenu.style.display === 'none') {
                            mobileControls.style.display = 'block';
                        } else {
                            mobileControls.style.display = 'none';
                        }
                    }
                    
                    setInterval(updateMobileControls, 200);
                    
                    // Setup Virtual Joystick
                    const joystickBase = document.getElementById('joystickBase');
                    const joystickKnob = document.getElementById('joystickKnob');
                    
                    if (joystickBase && joystickKnob) {
                        let joystick = {
                            active: false,
                            startX: 0,
                            startY: 0,
                            deltaX: 0,
                            deltaY: 0
                        };
                        
                        // Touch start
                        joystickBase.addEventListener('touchstart', function(e) {
                            e.preventDefault();
                            const touch = e.touches[0];
                            const rect = joystickBase.getBoundingClientRect();
                            
                            joystick.active = true;
                            joystick.startX = rect.left + rect.width / 2;
                            joystick.startY = rect.top + rect.height / 2;
                        });
                        
                        // Touch move
                        document.addEventListener('touchmove', function(e) {
                            if (!joystick.active) return;
                            e.preventDefault();
                            
                            const touch = e.touches[0];
                            const deltaX = touch.clientX - joystick.startX;
                            const deltaY = touch.clientY - joystick.startY;
                            const maxDistance = 50;
                            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                            
                            if (distance <= maxDistance) {
                                joystick.deltaX = deltaX;
                                joystick.deltaY = deltaY;
                            } else {
                                const angle = Math.atan2(deltaY, deltaX);
                                joystick.deltaX = Math.cos(angle) * maxDistance;
                                joystick.deltaY = Math.sin(angle) * maxDistance;
                            }
                            
                            // Update visual position
                            joystickKnob.style.transform = `translate(-50%, -50%) translate(${joystick.deltaX}px, ${joystick.deltaY}px)`;
                            
                            // Simulate keyboard input
                            const threshold = 15;
                            simulateKeys({
                                w: joystick.deltaY < -threshold,
                                s: joystick.deltaY > threshold,
                                a: joystick.deltaX < -threshold,
                                d: joystick.deltaX > threshold
                            });
                        });
                        
                        // Touch end
                        document.addEventListener('touchend', function(e) {
                            if (!joystick.active) return;
                            
                            joystick.active = false;
                            joystick.deltaX = 0;
                            joystick.deltaY = 0;
                            
                            // Reset visual position
                            joystickKnob.style.transform = 'translate(-50%, -50%)';
                            
                            // Release all keys
                            simulateKeys({ w: false, s: false, a: false, d: false });
                        });
                    }
                    
                    // Mobile button handlers
                    function addMobileButton(buttonId, action) {
                        const button = document.getElementById(buttonId);
                        if (button) {
                            button.addEventListener('touchstart', function(e) {
                                e.preventDefault();
                                action();
                            });
                        }
                    }
                    
                    // Add mobile button events
                    addMobileButton('mobileAutoBtn', function() {
                        // Simulate T key for auto-target
                        simulateKeyPress('KeyT', 84);
                    });
                    
                    addMobileButton('mobileStoreBtn', function() {
                        // Simulate B key for store
                        simulateKeyPress('KeyB', 66);
                    });
                    
                    addMobileButton('mobileWallBtn', function() {
                        // Simulate R key for walls
                        simulateKeyPress('KeyR', 82);
                    });
                    
                    addMobileButton('mobilePauseBtn', function() {
                        if (typeof togglePause === 'function') {
                            togglePause();
                        }
                    });
                }
            }
            
            // Key simulation functions
            let currentKeys = { w: false, s: false, a: false, d: false };
            
            function simulateKeys(keys) {
                for (let key in keys) {
                    if (keys[key] !== currentKeys[key]) {
                        currentKeys[key] = keys[key];
                        const eventType = keys[key] ? 'keydown' : 'keyup';
                        const keyCode = { w: 87, s: 83, a: 65, d: 68 }[key];
                        
                        const event = new KeyboardEvent(eventType, {
                            key: key.toUpperCase(),
                            code: `Key${key.toUpperCase()}`,
                            keyCode: keyCode,
                            which: keyCode,
                            bubbles: true
                        });
                        document.dispatchEvent(event);
                    }
                }
            }
            
            function simulateKeyPress(code, keyCode) {
                const key = code.replace('Key', '').toLowerCase();
                
                // Key down
                const downEvent = new KeyboardEvent('keydown', {
                    key: key.toUpperCase(),
                    code: code,
                    keyCode: keyCode,
                    which: keyCode,
                    bubbles: true
                });
                document.dispatchEvent(downEvent);
                
                // Key up after short delay
                setTimeout(() => {
                    const upEvent = new KeyboardEvent('keyup', {
                        key: key.toUpperCase(),
                        code: code,
                        keyCode: keyCode,
                        which: keyCode,
                        bubbles: true
                    });
                    document.dispatchEvent(upEvent);
                }, 100);
            }
        });


    </script>
</body>
</html>

















